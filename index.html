<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QuickSum - Your Friendly Text Buddy</title>
    <meta name="description" content="A smart and lovable assistant that helps users make sense of long content in seconds." />
    <meta name="author" content="QuickSum" />

    <meta property="og:title" content="QuickSum - Your Friendly Text Buddy" />
    <meta property="og:description" content="A smart and lovable assistant that helps users make sense of long content in seconds." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
  </head>
  <body>
    <div id="root"></div>

    <!-- Start: Feedback Section (Updated image) -->
    <div style="max-width:600px;margin:36px auto 25px auto;padding:0 20px;">
      <div style="
        display:flex;
        gap:24px;
        background:#fff;
        border-radius:10px;
        box-shadow:0 1px 10px rgba(40,54,120,0.06);
        padding:20px 24px 20px 20px;
        align-items:center;
      ">
        <img src="public/lovable-uploads/50f87b95-c2f7-47f1-ab57-f2f79f1a0192.png" alt="Feedback" style="width:112px;height:112px;object-fit:cover;border-radius:10px;border:2px solid #eee;box-shadow:0 1px 8px #efefef;" />
        <form id="feedbackForm" style="flex:1;">
          <div style="font-size:19px;font-weight:600;margin-bottom:4px;color:#1a1f2c;">Share your feedback</div>
          <div style="font-size:14px;color:#555;margin-bottom:10px;">Tell us about your summarization experience!</div>
          <textarea id="feedbackText" rows="2" placeholder="Write your feedback..." style="width:100%;border-radius:6px;border:1px solid #ccc;padding:7px 9px;font-size:14px;margin-bottom:8px;resize:vertical;"></textarea>
          <div>
            <button type="submit" style="background:#9b87f5;color:#fff;font-weight:500;padding:7px 20px;border:none;border-radius:4px;cursor:pointer;">Send Feedback</button>
            <span id="feedbackStatus" style="margin-left:14px;font-size:13px;color:#3587fe;font-weight:500;display:none;"></span>
          </div>
        </form>
      </div>
    </div>
    <!-- End: Feedback Section -->

    <!-- Start: Enhanced Summarizer UI -->
    <div style="max-width:600px;margin:40px auto;padding:20px;border:1px solid #eee;border-radius:8px;background:#fafcff;">
      <textarea id="inputText" placeholder="Enter text here..." rows="8" cols="60" style="width:100%;padding:10px;border-radius:4px;border:1px solid #ccc;display:block;"></textarea>
      <div style="margin:12px 0;">
        <input type="file" id="pdfInput" accept="application/pdf" style="margin-top:8px;" />
        <span style="font-size:13px;color:#888;margin-left:10px;">Optional: Upload PDF</span>
      </div>
      <button onclick="summarizeText()" style="padding:8px 20px;border-radius:4px;background:#3587fe;color:white;font-weight:bold;border:none;cursor:pointer;">Summarize</button>
      <p style="margin-top:16px;"><strong>Summary:</strong></p>
      <div id="output" style="min-height:40px;border:1px solid #eef;padding:10px;border-radius:4px;background:#f6faff;"></div>
    </div>
    <!-- End: Enhanced Summarizer UI -->

    <!-- Start: Footer With Image (Updated image) -->
    <div style="max-width:100vw;margin:0 auto;padding:0;">
      <div style="
        width:100%;max-width:1240px;margin:0 auto 0 auto;height:100px;overflow:hidden;
        border-radius:0 0 12px 12px;
        display:flex;align-items:end;
        background:url('public/lovable-uploads/501a7e70-063a-479e-ac58-6c2dd652e062.png') no-repeat left center #fff;
        background-size:auto 85px;
        border:1px solid #eee;
        border-top:none;
        box-shadow:0 3px 10px #00000008
      "></div>
      <footer style="max-width:1240px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;padding:2px 30px 10px 30px;font-size:16px;color:#888;">
        <div>
          <span style="display:flex;align-items:center;gap:6px;">
            <img src="public/lovable-uploads/501a7e70-063a-479e-ac58-6c2dd652e062.png" alt="QuickSum Footer" style="height:20px;width:20px;border-radius:3px;object-fit:cover;box-shadow:0 1px 2px #eee;" />
            <span style="font-weight:bold;color:#221F26;">QuickSum</span>
          </span>
        </div>
        <nav style="display:flex;gap:26px;">
          <a href="#" style="color:#888;text-decoration:none;">About</a>
          <a href="#" style="color:#888;text-decoration:none;">Features</a>
          <a href="#" style="color:#888;text-decoration:none;">Pricing</a>
          <a href="#" style="color:#888;text-decoration:none;">Blog</a>
          <a href="#" style="color:#888;text-decoration:none;">Contact</a>
        </nav>
      </footer>
    </div>
    <!-- End: Footer With Image -->

    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>

    <!-- Inline JS for Feedback + Summarizer -->
    <script>
      // Feedback submit logic
      document.getElementById("feedbackForm").onsubmit = function(e) {
        e.preventDefault();
        const text = document.getElementById("feedbackText").value.trim();
        const status = document.getElementById("feedbackStatus");
        if (text.length < 3) {
          status.innerText = "Please enter feedback before sending.";
          status.style.color = "#ea384c";
          status.style.display = "inline";
          return;
        }
        // For demo: just show success state
        status.innerText = "Thanks for your feedback!";
        status.style.color = "#13b07d";
        status.style.display = "inline";
        document.getElementById("feedbackText").value = "";
        setTimeout(() => status.style.display = "none", 3100);
      };

      // Summarizer logic
      async function extractTextFromPDF(file) {
        return new Promise((resolve) => {
          const reader = new FileReader();
          reader.onload = function(event) {
            try {
              // Basic ASCII extraction (very simplified!)
              const uint8 = new Uint8Array(event.target.result);
              let text = '';
              for (let i = 0; i < uint8.length; i++) {
                if (uint8[i] >= 32 && uint8[i] <= 126) {
                  text += String.fromCharCode(uint8[i]);
                }
              }
              text = text.replace(/[^\w\s.,?!;:'"()-]/g, ' ').replace(/\s+/g, ' ').trim();
              // If text is short, provide fallback
              if (text.length < 80) {
                resolve('This PDF could not be fully read in your browser. Please copy & paste text instead.');
              } else {
                resolve(text);
              }
            } catch {
              resolve('Error reading PDF content. Please try another file or paste your text.');
            }
          };
          reader.onerror = function() {
            resolve('Error reading PDF file.');
          };
          reader.readAsArrayBuffer(file);
        });
      }

      async function summarizeText() {
        const textAreaValue = document.getElementById("inputText").value;
        const pdfInput = document.getElementById("pdfInput");
        const pdfFile = pdfInput && pdfInput.files && pdfInput.files[0];
        document.getElementById("output").innerText = "Summarizing...";

        let contentToSummarize = textAreaValue;
        if (pdfFile) {
          contentToSummarize = await extractTextFromPDF(pdfFile);
        }
        if (!contentToSummarize || contentToSummarize.trim().length < 5) {
          document.getElementById("output").innerText = "Please provide text or a readable PDF file.";
          return;
        }

        try {
          const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyDdbLRPhyqzxsMz4TOlqC3THnW-pjbcy5Q", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              contents: [
                {
                  parts: [
                    { text: "Summarize this text:\n" + contentToSummarize }
                  ]
                }
              ]
            })
          });

          const data = await response.json();
          const summary = data?.candidates?.[0]?.content?.parts?.[0]?.text || "No summary found.";
          document.getElementById("output").innerText = summary;
        } catch (err) {
          document.getElementById("output").innerText = "Error summarizing. Please try again later.";
        }
      }
    </script>
  </body>
</html>
